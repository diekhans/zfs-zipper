#!/usr/bin/env python
"""ZFS-based backup driver with rotating backup sets.

A BackupSet consists of BackupPools, for backing up the same set of source data
and can be rotated.  A BackupPool could be a single disk or a RAID pool.

The source file system structure is reproduced under the top level BackupPool
file system. Snapshots of the source file systems are use to manage the backup
on the BackupPool file systems.

Snapshots are named in the form:
    backuper_<GMT>_<backupset>_full_<backuppool>
    backuper_<GMT>_<backupset>_incr

When a source FS is first backed up to a BackupPool, a full snapshot, specific
to that pool is created.  This serves as a baseline for the incrementals.  If
the source full pool is to be destroyed, a new full backup for the target pool
must first be made.  The corresponding backup full snapshot does not need
to be destroyed.  All that matters is the latest full is on both the source FS
and the specific BackupPool FS.  
"""

import os, sys, re, subprocess, time
from markd.zfsBackuper import zfs
from markd.zfsBackuper.backuper import FsBackup


